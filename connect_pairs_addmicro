import pandas as pd

# Generate 20 example strings
example_strings = [
    "word1_word2_INI_corei1_coreia1_word6_word7",
    "word1_word2_INI_corei2_coreia2_word6_word7",
    "word1_word2_INI_corei3_coreia3_word6_word7",
    "word1_word2_INI_corei4_coreia4_word6_word7",
    "word1_word2_INI_corei5_coreia5_word6_word7",
    "word1_word2_body_coreb1_coreba1_word6_word7",
    "word1_word2_body_corebw1_corebaq1_word6_word7",
    "word1_word2_body_corebr1_corebat1_word6_word7",
    "word1_word2_body_corebx2_corebay2_word6_word7",
    "word1_word2_body_coreb3_coreba3_word6_word7",
    "word1_word2_body_coreb4_coreba4_word6_word7",
    "word1_word2_body_coreb5_coreba5_word6_word7",
    "word1_word2_body_coreby_corebay_word6_word7",
    "word1_word2_body1_coreb1_coreba1_word6_word7",
    "word1_word2_body1_corebw1_corebaq1_word6_word7",
    "word1_word2_body1_corebr1_corebat1_word6_word7",
    "word1_word2_body1_corebx2_corebay2_word6_word7",
    "word1_word2_body1_coreb3_coreba3_word6_word7",
    "word1_word2_body1_coreb4_coreba4_word6_word7",
    "word1_word2_body1_coreb5_coreba5_word6_word7",
    "word1_word2_body1_coreby_corebay_word6_word7",
]

# Split the strings into two lists: ini_vectors and body_vectors
ini_vectors = []
body_vectors = []

for string in example_strings:
    words = string.split("_")
    if "INI" in words[2]:
        ini_vectors.append(words)
    else:
        body_vectors.append(words)

# Create DataFrames for ini_vectors and body_vectors
ini_df = pd.DataFrame(ini_vectors, columns=["column 1", "column 2", "column 3", "column 4", "column 5", "column 6", "column 7"])
body_df = pd.DataFrame(body_vectors, columns=["column 1", "column 2", "column 3", "column 4", "column 5", "column 6", "column 7"])

# Create a mapping table from a CSV file
mapping_csv = """ini_core1,ini_core2,body_core1,body_core2
"corei1,coreia1,coreb1,coreba1",
"corei1,coreia1,corebw1,corebaq1",
"corei1,coreia1,corebr1,corebat1",
"corei2,coreia2,corebx2,corebay2",
"corei3,coreia3,coreb3,coreba3",
"corei4,coreia4,coreb4,coreba4",
"corei5,coreia5,coreb5,coreba5",
"corei5,coreia5,coreby,corebay"
"""

# Create the mapping DataFrame from the CSV data
mapping_df = pd.read_csv(pd.compat.StringIO(mapping_csv))

# Join ini_df and mapping_df on column 4, and body_df and mapping_df on column 5
ini_result = pd.merge(ini_df, mapping_df, left_on="column 4", right_on="ini_core1", how="left")
body_result = pd.merge(body_df, mapping_df, left_on="column 5", right_on="body_core1", how="left")

# Print the results
print("ini_result:")
print(ini_result)

print("\nbody_result:")
print(body_result)
